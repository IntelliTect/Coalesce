version: 2.0.{build}
branches:
  only:
  - master
  - 2.0
  - Add-Nuget-Publish
image: Visual Studio 2017
configuration: Debug
platform: Any CPU
nuget:
  disable_publish_on_pr: true
before_build:
- cmd: >-
    nuget restore

    cd src\Coalesce.Web

    npm install

    npm -g install gulp-cli

    gulp coalesce

    cd ..\Coalesce.Domain

    dotnet ef database update
build:
  project: Coalesce.sln
  publish_nuget: true
  verbosity: minimal
deploy:
  provider: NuGet
  api_key:
    secure: g3Dms5GNcFV0iAs60oLF6AWOGa3gCWlwgUn8FbMklYI14LrmRdnBFTW6dmsyJQmc
  skip_symbols: true
  artifact: /.*\.nupkg/
  on:
    appveyor_repo_tag: true
