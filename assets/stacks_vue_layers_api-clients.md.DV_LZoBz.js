import{_ as t,c as l,I as n,a7 as o,l as e,a as s,D as r,o as c}from"./chunks/framework.BkavzUpE.js";const Q=JSON.parse('{"title":"Vue API Client Layer","description":"","frontmatter":{},"headers":[],"relativePath":"stacks/vue/layers/api-clients.md","filePath":"stacks/vue/layers/api-clients.md"}'),p={name:"stacks/vue/layers/api-clients.md"},i=o(`<h1 id="vue-api-client-layer" tabindex="-1">Vue API Client Layer <a class="header-anchor" href="#vue-api-client-layer" aria-label="Permalink to &quot;Vue API Client Layer&quot;">​</a></h1><p>The API client layer, generated as <code>api-clients.g.ts</code>, exports a class for each API controller that was generated for your data model. These classes are stateless and provide one method for each API endpoint. This includes both the standard set of endpoints created for <a href="/Coalesce/modeling/model-types/crud.html">CRUD Models</a>, as well as any custom <a href="/Coalesce/modeling/model-components/methods.html">Methods</a> on the aforementioned types, as well as any methods on your <a href="/Coalesce/modeling/model-types/services.html">Services</a>.</p><p>The API clients provided by Coalesce are based on <a href="https://github.com/axios/axios" target="_blank" rel="noreferrer">axios</a>. All API clients used a shared axios instance, exported from <code>coalesce-vue</code> as <code>AxiosClient</code>. This instance can be used to configure all HTTP requests made by Coalesce, including things like attaching <a href="https://axios-http.com/docs/interceptors" target="_blank" rel="noreferrer">interceptors</a> to modify the requests being made, or configuring <a href="https://axios-http.com/docs/config_defaults" target="_blank" rel="noreferrer">defaults</a>.</p><p>As with all the layers, the <a href="https://github.com/IntelliTect/Coalesce/blob/dev/src/coalesce-vue/src/api-client.ts" target="_blank" rel="noreferrer">source code of coalesce-vue</a> is also a great supplement to this documentation.</p><h2 id="concepts" tabindex="-1">Concepts <a class="header-anchor" href="#concepts" aria-label="Permalink to &quot;Concepts&quot;">​</a></h2><h3 id="api-client" tabindex="-1">API Client <a class="header-anchor" href="#api-client" aria-label="Permalink to &quot;API Client&quot;">​</a></h3><p>API Clients are classes, generated for each controller-backed type in your data model as <code>&lt;ModelName&gt;ApiClient</code> and exported from <code>api-clients.g.ts</code> containing a method for each API endpoint.</p><p>Each method on the API client takes in the regular parameters of the method as you would expect, as well as an optional <code>AxiosRequestConfig</code> parameter at the end that can be used to provide additional configuration for the single request, if needed.</p><p>For the methods that correspond to the standard set of CRUD endpoints that Coalesce provides (<code>get</code>, <code>list</code>, <code>count</code>, <code>save</code>, <code>bulkSave</code>, <code>delete</code>), an additional parameter <code>parameters</code> is available that accepts the set of <a href="/Coalesce/modeling/model-components/data-sources.html#standard-parameters">Standard Parameters</a> appropriate for the endpoint.</p><p>Each method returns a <code>Promise&lt;AxiosResponse&lt;TApiResult&gt;&gt;</code> where <code>TApiResult</code> is either <code>ItemResult</code>, <code>ItemResult&lt;T&gt;</code>, or <code>ListResult&lt;T&gt;</code>, depending on the return type of the API endpoint. <code>AxiosResponse</code> is the <a href="https://axios-http.com/docs/res_schema" target="_blank" rel="noreferrer">response object from axios</a>, containing the <code>TApiResult</code> in its <code>data</code> property, as well as other properties like <code>headers</code>. The returned type <code>T</code> is automatically converted into valid <a href="/Coalesce/stacks/vue/layers/models.html">Model implementations</a> for you.</p><h3 id="api-callers-api-states" tabindex="-1">API Callers/API States <a class="header-anchor" href="#api-callers-api-states" aria-label="Permalink to &quot;API Callers/API States&quot;">​</a></h3><p>A stateful function for invoking an API endpoint, created with the <code>$makeCaller</code> function on an API Client. API Callers provide a wide array of functionality that is useful for working with API endpoints that are utilized by a user interface.</p><p>Because they are such an integral part of the overall picture of <code>coalesce-vue</code>, they have <a href="/Coalesce/stacks/vue/layers/api-clients.html">their own section below</a> where they are explained in much greater detail.</p><h2 id="api-callers" tabindex="-1">API Callers <a class="header-anchor" href="#api-callers" aria-label="Permalink to &quot;API Callers&quot;">​</a></h2><p>API Callers (typed with the name <code>ApiState</code> in <code>coalesce-vue</code>, sometimes also referred to as &quot;loaders&quot; or &quot;invokers&quot;) are stateful functions for invoking an API endpoint, created with the <code>$makeCaller</code> function on an API Client. A summary of features:</p><h4 id="endpoint-invocation" tabindex="-1">Endpoint Invocation <a class="header-anchor" href="#endpoint-invocation" aria-label="Permalink to &quot;Endpoint Invocation&quot;">​</a></h4><p>Each API Caller is itself a function, so it can be invoked to trigger an API request to the server.</p><h4 id="state-management" tabindex="-1">State management <a class="header-anchor" href="#state-management" aria-label="Permalink to &quot;State management&quot;">​</a></h4><p>API Callers contain properties about the last request made, including things like <code>wasSuccessful</code>, <code>isLoading</code>, <code>result</code>, and more. <a href="#properties">Read More</a>.</p><h4 id="concurrency-management" tabindex="-1">Concurrency Management <a class="header-anchor" href="#concurrency-management" aria-label="Permalink to &quot;Concurrency Management&quot;">​</a></h4><p>Using <code>setConcurrency(mode)</code>, you can configure how each individual caller handles what happens when multiple requests are made simultaneously. <a href="#concurrency-mode">Read More</a>.</p><h4 id="argument-binding" tabindex="-1">Argument Binding <a class="header-anchor" href="#argument-binding" aria-label="Permalink to &quot;Argument Binding&quot;">​</a></h4><p>API Callers can be created so that they have an <code>args</code> object that can be bound to, using <code>.invokeWithArgs()</code> to make a request using those arguments as the API endpoint&#39;s parameters. The API Callers created for the <a href="/Coalesce/stacks/vue/layers/viewmodels.html">ViewModel Layer</a> are all created this way.</p><h3 id="creating-and-invoking-an-api-caller" tabindex="-1">Creating and Invoking an API Caller <a class="header-anchor" href="#creating-and-invoking-an-api-caller" aria-label="Permalink to &quot;Creating and Invoking an API Caller&quot;">​</a></h3><p>API Callers can be created with the <code>$makeCaller</code> method of an API Client. If desired, you can define parameters that will be accepted as input to each invocation.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>During typical development, it is unlikely that you&#39;ll need to make a custom API Caller - the ones created for you on the generated <a href="/Coalesce/stacks/vue/layers/viewmodels.html">ViewModel Layer</a> will usually suffice. However, creating your own can allow for some more advanced functionality.</p></div><p>Some examples:</p><p>A caller that takes no additional parameters:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dark-plus vp-code"><code><span class="line"><span style="color:#6A9955;">// Preamble for all the examples below:</span></span>
<span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">PersonApiClient</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#CE9178;"> &#39;@/api-clients.g&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> client</span><span style="color:#D4D4D4;"> = </span><span style="color:#569CD6;">new</span><span style="color:#DCDCAA;"> PersonApiClient</span><span style="color:#D4D4D4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> caller</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">client</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$makeCaller</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#CE9178;">    &quot;item&quot;</span><span style="color:#D4D4D4;">, </span></span>
<span class="line"><span style="color:#9CDCFE;">    c</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#9CDCFE;"> c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;A&quot;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">await</span><span style="color:#DCDCAA;"> caller</span><span style="color:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">result</span><span style="color:#D4D4D4;">)</span></span></code></pre></div><p>A caller that takes custom parameters:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dark-plus vp-code"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> caller</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">client</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$makeCaller</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#9CDCFE;">    methods</span><span style="color:#569CD6;"> =&gt;</span><span style="color:#9CDCFE;"> methods</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">namesStartingWith</span><span style="color:#D4D4D4;">, </span></span>
<span class="line"><span style="color:#D4D4D4;">    (</span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">await</span><span style="color:#DCDCAA;"> caller</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Rob&quot;</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">result</span><span style="color:#D4D4D4;">)</span></span></code></pre></div><p>A caller that has an args object that can be bound to. This is how the generated API Callers in the <a href="/Coalesce/stacks/vue/layers/viewmodels.html">ViewModel Layer</a> are created:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dark-plus vp-code"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> caller</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">client</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$makeCaller</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;item&quot;</span><span style="color:#D4D4D4;">, </span></span>
<span class="line"><span style="color:#6A9955;">    // The parameter-based version is always required, even if it won&#39;t be used.</span></span>
<span class="line"><span style="color:#D4D4D4;">    (</span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#6A9955;">    // A function which creates a blank instance of the args object.</span></span>
<span class="line"><span style="color:#6A9955;">    // All props should be initialized (i.e. not undefined) to work with Vue&#39;s reactivity.</span></span>
<span class="line"><span style="color:#D4D4D4;">    () </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> ({</span><span style="color:#9CDCFE;">str:</span><span style="color:#569CD6;"> null</span><span style="color:#C586C0;"> as</span><span style="color:#4EC9B0;"> string</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">, }),</span></span>
<span class="line"><span style="color:#6A9955;">    // The function that accepts the args object and uses it:</span></span>
<span class="line"><span style="color:#D4D4D4;">    (</span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">args</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#9CDCFE;"> c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">args</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">args</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&quot;Su&quot;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#C586C0;">await</span><span style="color:#9CDCFE;"> caller</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">invokeWithArgs</span><span style="color:#D4D4D4;">();</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">result</span><span style="color:#D4D4D4;">)</span></span></code></pre></div><p>A caller that performs multiple async operations:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dark-plus vp-code"><code><span class="line"><span style="color:#569CD6;">const</span><span style="color:#4FC1FF;"> deleteFirstNameStartingWith</span><span style="color:#D4D4D4;"> = </span><span style="color:#9CDCFE;">client</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">$makeCaller</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#CE9178;">    &quot;item&quot;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#569CD6;">    async</span><span style="color:#D4D4D4;"> (</span><span style="color:#9CDCFE;">c</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#569CD6;">        const</span><span style="color:#4FC1FF;"> namesResult</span><span style="color:#D4D4D4;"> = </span><span style="color:#C586C0;">await</span><span style="color:#9CDCFE;"> c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">namesStartingWith</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">str</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#C586C0;">        return</span><span style="color:#C586C0;"> await</span><span style="color:#9CDCFE;"> c</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">deletePersonByName</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">namesResult</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">data</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">object</span><span style="color:#D4D4D4;">[</span><span style="color:#B5CEA8;">0</span><span style="color:#D4D4D4;">])</span></span>
<span class="line"><span style="color:#D4D4D4;">    }</span></span>
<span class="line"><span style="color:#D4D4D4;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C586C0;">await</span><span style="color:#DCDCAA;"> caller</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&quot;Rob&quot;</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">caller</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">result</span><span style="color:#D4D4D4;">)</span></span></code></pre></div><p>The first parameter, <code>resultType</code>, can either be one of <code>&quot;item&quot;</code> or <code>&quot;list&quot;</code>, indicating whether the method returns a <code>ItemResult</code> or <code>ListResult</code> (examples #1 and #3 above). It can also be a function which accepts the set of method metadata for the API Client and which returns the specific method metadata (example #2 above), or it can be a direct reference to a specific method metadata object.</p><h3 id="properties" tabindex="-1">Properties <a class="header-anchor" href="#properties" aria-label="Permalink to &quot;Properties&quot;">​</a></h3><p>The following state properties can be found on API Caller instances. These properties are useful for binding to in a user interface to display errors, results, or indicators of progress.</p><h4 id="all-callers" tabindex="-1">All Callers <a class="header-anchor" href="#all-callers" aria-label="Permalink to &quot;All Callers&quot;">​</a></h4>`,39),d=e("p",null,"True if there is currently a request pending for the API Caller.",-1),h=e("p",null,[s("A boolean indicating if the last request was successful. "),e("code",null,"null"),s(" if no request has been made yet or if a request has been made but has not yet completed.")],-1),u=e("p",null,[s("An message from the last request. Typically an error message if the last request failed, but messages can also be provided with successful "),e("code",null,"ApiResult"),s(" responses in your "),e("a",{href:"/Coalesce/modeling/model-components/methods.html"},"custom methods"),s(".")],-1),D=e("p",null,[s("True if "),e("code",null,"result"),s(" is non-null. This prop is useful in performance-critical scenarios where checking "),e("code",null,"result"),s(" directly will cause an overabundance of re-renders in high-churn scenarios.")],-1),y=e("p",null,[s("Holds an object for the arguments of the function, and will be used if the caller is invoked with its "),e("code",null,"invokeWithArgs()"),s(" method. Useful for binding the arguments of a caller to inputs in a user interface.")],-1),m=e("p",null,"Only exists if the caller was created with the option of being invoked with an args object as described in the sections above.",-1),C=e("p",null,[s("Returns the URL for the method's HTTP endpoint. Any parameters are sourced from the "),e("code",null,"args"),s(" object. Useful for binding file-returning HTTP GET methods directly to "),e("code",null,"image"),s(" or "),e("code",null,"video"),s(" HTML elements.")],-1),f=e("p",null,"Only exists if the caller was created with the option of being invoked with an args object as described in the sections above.",-1),g=e("br",null,null,-1),b=e("h4",{id:"itemresult-based-callers",tabindex:"-1"},[s("ItemResult-based Callers "),e("a",{class:"header-anchor",href:"#itemresult-based-callers","aria-label":'Permalink to "ItemResult-based Callers"'},"​")],-1),v=e("p",null,"The principal data returned by the previous request. Will be set to null if the last response received returned no data (e.g. if the response was an error response)",-1),A=e("p",null,[s("Any validation issues returned by the previous request. This is never populated automatically by Coalesce, and is therefore is only used if you have written custom code to populate it in your "),e("a",{href:"/Coalesce/modeling/model-components/behaviors.html"},"Behaviors"),s(" or "),e("a",{href:"/Coalesce/modeling/model-components/methods.html"},"Methods"),s(".")],-1),w=e("br",null,null,-1),q=e("h4",{id:"listresult-based-callers",tabindex:"-1"},[s("ListResult-based Callers "),e("a",{class:"header-anchor",href:"#listresult-based-callers","aria-label":'Permalink to "ListResult-based Callers"'},"​")],-1),k=e("p",null,"The principal data returned by the previous request. Will be set to null if the last response received returned no data (e.g. if the response was an error response).",-1),_=e("p",null,"Properties which contain the pagination information returned by the previous request.",-1),P=e("h3",{id:"concurrency-mode",tabindex:"-1"},[s("Concurrency Mode "),e("a",{class:"header-anchor",href:"#concurrency-mode","aria-label":'Permalink to "Concurrency Mode"'},"​")],-1),I=o('<p>API callers have a <code>setConcurrency</code> method that allows you to customize how they behave when additional invocations are performed when there is already a request pending. There are four options available, with <code>&quot;disallow&quot;</code> being the default:</p><h5 id="disallow" tabindex="-1"><code>&quot;disallow&quot;</code> <a class="header-anchor" href="#disallow" aria-label="Permalink to &quot;`&quot;disallow&quot;`&quot;">​</a></h5><p>The default behavior - simply throws an error for any secondary invocations.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Having <code>&quot;disallow&quot;</code> as the default prevents the unexpected behavior that can happen in a number of ways with the other modes:</p><ul><li>For requests that are performing data-mutating actions on the server, all other concurrency modes could lead to an unexpected end state of the data due to requests either being abandoned, cancelled, or potentially happening out-of-order.</li><li>Throwing errors for multiple concurrent requests quickly surfaces issues during development where concurrent requests are not being correctly guarded against in a user interface - e.g. not disabling a &quot;Save&quot; or &quot;Submit&quot; button while the request is pending, which would otherwise lead to double-posts.</li></ul></div><h5 id="debounce" tabindex="-1"><code>&quot;debounce&quot;</code> <a class="header-anchor" href="#debounce" aria-label="Permalink to &quot;`&quot;debounce&quot;`&quot;">​</a></h5><p>When a secondary invocation is performed, enqueue it after the current pending invocation completes.</p><p>If additional invocations are performed while there is already an invocation enqueued and waiting, the already-enqueued invocation is abandoned and replaced by the most recent invocation attempt. The promise of the abandoned invocation will be resolved with <code>undefined</code> (it is NOT rejected).</p><h5 id="cancel" tabindex="-1"><code>&quot;cancel&quot;</code> <a class="header-anchor" href="#cancel" aria-label="Permalink to &quot;`&quot;cancel&quot;`&quot;">​</a></h5><p>When a secondary invocation is performed, cancel the current pending invocation.</p><p>This completely aborts the request, propagating all the way back to the server where cancellation can be observed with <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.httpcontext.requestaborted" target="_blank" rel="noreferrer">HttpContext.RequestAborted</a>. The promise of the cancelled invocation will be resolved with <code>undefined</code> (it is NOT rejected).</p><h5 id="allow" tabindex="-1"><code>&quot;allow&quot;</code> <a class="header-anchor" href="#allow" aria-label="Permalink to &quot;`&quot;allow&quot;`&quot;">​</a></h5><p>When a secondary invocation is performed, always continue normally, sending the request to the server.</p><p>The state of the properties on the caller at any time will reflect the most recent response received from the server, which is never guaranteed to correlate with the most recent request made to the server - that is, requests are not guaranteed to complete in the order they were made. In particular, the <code>isLoading</code> property will be <code>false</code> after the first response comes back, even if the second response has not yet been received.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>For the reasons outlined above, it is generally not recommended to use <code>&quot;allow&quot;</code> unless you fully understand the drawbacks. This mode mirrors the legacy behavior of the Knockout stack for Coalesce.</p></div><h3 id="response-caching" tabindex="-1">Response Caching <a class="header-anchor" href="#response-caching" aria-label="Permalink to &quot;Response Caching&quot;">​</a></h3><p>Response caching on API Callers is a feature that will save API responses to persistent storage (<code>sessionStorage</code> or <code>localStorage</code>). The next time a matching request is made, the <code>result</code> property of the API Caller will be populated with that saved response, allowing for a faster time to interactivity and reduced repaints and shifting of elements as initial data loads after a page navigation. It does not <em>prevent</em> any HTTP requests from being made, and does not affect the <code>Promise</code> returned from <code>invoke</code> or <code>invokeWithArgs</code>.</p><p>Common use cases include:</p><ul><li>Site-wide status or alert messages</li><li>Server-provided configuration</li><li>Dashboard data, like statistics or graphs</li></ul><p>When a cached response is loaded, <code>result</code> is populated with that response&#39;s data, <code>wasSuccessful</code> and <code>hasResult</code> are set to <code>true</code>, and <code>onFulfilled</code> callbacks are invoked.</p>',19),T=o(`<p>Enables response caching on the API Caller. Only <a href="/Coalesce/modeling/model-components/attributes/controller-action.html">HTTP GET methods</a> are supported, and <a href="/Coalesce/modeling/model-components/methods.html#file-downloads">file-returning methods</a> are not supported. Call with <code>false</code> to disable caching after it was previously enabled. The available options are as follows:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dark-plus vp-code"><code><span class="line"><span style="color:#C586C0;">export</span><span style="color:#569CD6;"> type</span><span style="color:#4EC9B0;"> ResponseCachingConfiguration</span><span style="color:#D4D4D4;"> = {</span></span>
<span class="line"><span style="color:#6A9955;">  /** Function that will determine the cache key used for a particular request.</span></span>
<span class="line"><span style="color:#6A9955;">   * Return a falsy value to prevent caching. The default key is the request URL.</span></span>
<span class="line"><span style="color:#6A9955;">   */</span></span>
<span class="line"><span style="color:#DCDCAA;">  key</span><span style="color:#D4D4D4;">?: (</span></span>
<span class="line"><span style="color:#9CDCFE;">    req</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">AxiosRequestConfig</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#9CDCFE;">    defaultKey</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">string</span></span>
<span class="line"><span style="color:#D4D4D4;">  ) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#4EC9B0;"> string</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">undefined</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">  /** The maximum age of a cached response. If null, the entry will not expire. Default 1 hour.</span></span>
<span class="line"><span style="color:#6A9955;">   *</span></span>
<span class="line"><span style="color:#6A9955;">   * The smallest of the current configured max age and the max age that was set at the time of the cached response is used. */</span></span>
<span class="line"><span style="color:#9CDCFE;">  maxAgeSeconds</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">number</span><span style="color:#D4D4D4;"> | </span><span style="color:#4EC9B0;">null</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;">  /** The Storage (default \`sessionStorage\`) that will hold cached responses. */</span></span>
<span class="line"><span style="color:#9CDCFE;">  storage</span><span style="color:#D4D4D4;">?: </span><span style="color:#4EC9B0;">Storage</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">};</span></span></code></pre></div><h3 id="other-methods" tabindex="-1">Other Methods <a class="header-anchor" href="#other-methods" aria-label="Permalink to &quot;Other Methods&quot;">​</a></h3><p>API Callers have a few other methods available as well:</p>`,4),E=e("p",null,[s("Manually cancel the current request. The promise of the cancelled invocation will be resolved with "),e("code",null,"undefined"),s(" (it is NOT rejected). If using concurrency mode "),e("code",null,'"allow"'),s(", only the most recent invocation is cancelled.")],-1),F=e("p",null,[s("Add a callback to the caller to be invoked when a success response is received from the server. If a promise is returned, this promise will be awaited and will delay the setting of the "),e("code",null,"isLoading"),s(" prop to "),e("code",null,"false"),s(" until it completes.")],-1),x=e("p",null,[s("Add a callback to the caller to be invoked when a failure response is received from the server. If a promise is returned, this promise will be awaited and will delay the setting of the "),e("code",null,"isLoading"),s(" prop to "),e("code",null,"false"),s(" until it completes.")],-1),R=e("p",null,"Invokes the endpoint with provided args.",-1),S=e("p",null,[s("The invoke function is a reference from the caller to itself. In other words, "),e("code",null,"caller.invoke === caller"),s(".")],-1),L=e("p",null,[s("Similar to "),e("code",null,"invoke"),s(", but prompts for confirmation from the user (via "),e("code",null,"window.confirm"),s(") with the provided message.")],-1),B=e("p",null,[s("Invokes the endpoint with the specified args, defaulting to "),e("code",null,"caller.args"),s(".")],-1),W=e("p",null,"Only exists if the caller was created with the option of being invoked with an args object as described in the sections above.",-1),j=e("p",null,[s("Similar to "),e("code",null,"invokeWithArgs"),s(", but prompts for confirmation from the user (via "),e("code",null,"window.confirm"),s(") with the provided message.")],-1),V=e("p",null,[s("If the method returns a file, this method will return an "),e("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL",target:"_blank",rel:"noreferrer"},"Object URL"),s(" representing the value of the "),e("code",null,"result"),s(" prop.")],-1),M=e("p",null,[s("Accepts a "),e("code",null,"Vue"),s(" instance in order to manage the lifecycle of the URL, since object URLs must be manually released to avoid memory leaks. When the provided Vue component is destroyed, the object URL will be destroyed. If called inside the component template, the Vue instance can be acquired automatically.")],-1),N=e("p",null,"Only exists if the caller was created with the option of being invoked with an args object as described in the sections above.",-1);function U(O,$,H,z,G,K){const a=r("Prop");return c(),l("div",null,[i,n(a,{def:"isLoading: boolean",lang:"ts"}),d,n(a,{def:"wasSuccessful: boolean | null",lang:"ts"}),h,n(a,{def:"message: string | null",lang:"ts"}),u,n(a,{def:"hasResult: boolean",lang:"ts"}),D,n(a,{def:"args: {}",lang:"ts"}),y,m,n(a,{def:"get url(): string",lang:"ts"}),C,f,g,b,n(a,{def:"result: T | null",lang:"ts",id:"member-result-item"}),v,n(a,{def:"validationIssues: ValidationIssue[] | null",lang:"ts"}),A,w,q,n(a,{def:"result: Array<T> | null",lang:"ts",id:"member-result-list"}),k,n(a,{def:"page, pageSize, pageCount, totalCount: number | null",lang:"ts",id:"members-pagination"}),_,P,n(a,{def:"setConcurrency(mode: 'disallow' | 'debounce' | 'cancel' | 'allow')",lang:"ts"}),I,n(a,{def:"useResponseCaching(configuration?: ResponseCachingConfiguration | false)",lang:"ts"}),T,n(a,{def:"cancel(): void",lang:"ts"}),E,n(a,{def:"onFulfilled((state: TInvoker) => void | Promise<any>): void",lang:"ts"}),F,n(a,{def:"onRejected((state: TInvoker) => void | Promise<any>): void",lang:"ts"}),x,n(a,{def:"invoke(...args: TArgs)",lang:"ts"}),R,S,n(a,{def:"confirmInvoke(message: string, ...args: TArgs)",lang:"ts"}),L,n(a,{def:"invokeWithArgs(args?: TArgs)",lang:"ts"}),B,W,n(a,{def:"confirmInvokeWithArgs(message: string, args?: TArgs)",lang:"ts"}),j,n(a,{def:"getResultObjectUrl(vue?: Vue): string | undefined",lang:"ts"}),V,M,N])}const X=t(p,[["render",U]]);export{Q as __pageData,X as default};
